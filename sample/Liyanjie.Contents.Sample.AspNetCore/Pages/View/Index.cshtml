@page
@model Liyanjie.Contents.Sample.AspNetCore.Pages.View.IndexModel
@{
    Layout = "~/Pages/Shared/_Layout.cshtml";
}
@functions{
    string getId(params string[] input)
    {
        return input.ToString(",").MD5Encode_16bit();
    }
}
<style type="text/css" scoped>
    ul { margin: 20px 0; list-style: none; }
        ul li { margin: 5px 0; }
            ul li > header { position: relative; height: 30px; line-height: 30px; }
                ul li > header > b { display: inline-block; width: 60px; height: 100%; text-align: center; color: #fff; text-transform: uppercase; }
                ul li > header > span { position: absolute; right: 0; display: inline-block; }
            ul li > section { border-top: 1px solid; }
            ul li.GET { background-color: #e7f0f7; }
                ul li.GET > header > b { background-color: #0f6ab4; }
                ul li.GET > header > span { color: #0f6ab4; }
                ul li.GET > section { border-color: #c3d9ec; }
            ul li.POST { background-color: #e7f6ec; }
                ul li.POST > header > b { background-color: #10a54a; }
                ul li.POST > header > span { color: #10a54a; }
                ul li.POST > section { border-color: #c3e8d1; }
</style>
<ul>
    @foreach (var group in Model.ApiDocument.Resources.GroupBy(_ => _.GroupName))
    {
        @foreach (var api in group)
        {
            <li class="@api.HttpMethod">
                <header>
                    <b>@api.HttpMethod</b>
                    <a data-toggle="collapse" href="#@getId(api.HttpMethod,api.RelativePath)" aria-expanded="false" aria-controls="@getId(api.HttpMethod,api.RelativePath)">@Model.ApiDocument.BasePath@api.RelativePath</a>
                    <span>@api.Summary</span>
                </header>
                <section class="collapse" id="@getId(api.HttpMethod,api.RelativePath)">
                    <div>请求参数</div>
                    <table class="list">
                        <thead>
                            <tr>
                                <td class="name">名称</td>
                                <td class="desc">说明</td>
                                <td class="source">参数类型</td>
                                <td class="datatype">数据类型</td>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var parameter in api.Parameters)
                            {
                                <tr>
                                    <td>@parameter.Name</td>
                                    <td>@parameter.Summary</td>
                                    <td>@parameter.Source</td>
                                    <td>
                                        @if (parameter.Type.Definition == null)
                                        {
                                            <span>@parameter.Type.Name}}</span>
                                            @if (parameter.DefaultValue != null)
                                            {
                                                <span>(default：<pre style="display:inline">@parameter.DefaultValue</pre>)</span>
                                            }
                                        }
                                        else
                                        {

                                        }
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                    <div>返回结果</div>
                    <table class="list">
                        <thead>
                            <tr>
                                <td class="name">HTTP状态码</td>
                                <td class="desc">说明</td>
                                <td class="datatype">数据类型</td>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let response of resource.responses">
                                <td>{{response.statusCode}}</td>
                                <td>{{response.summary}}</td>
                                <td>
                                    <span *ngIf="!response.type.definition&&!response.type.itemType">{{response.type.name}}</span>
                                    <dl class="tabs" *ngIf="response.type.definition||response.type.itemType" #tabs>
                                        <dt [ngClass]="{selected:tabs.selected==1}" (click)="tabs.selected=1">模型</dt>
                                        <dd>
                                            <definition [type]="response.type" [bind]="response.bindExclude" [clude]="false" [definitions]="definitions"></definition>
                                        </dd>
                                        <dt [ngClass]="{selected:tabs.selected==2||!tabs.selected}" (click)="tabs.selected=2">示例</dt>
                                        <dd>
                                            <example [type]="response.type" [bind]="response.bindExclude" [clude]="false" [definitions]="definitions"></example>
                                        </dd>
                                    </dl>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </section>
            </li>
        }
    }
</ul>
